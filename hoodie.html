<!DOCTYPE html><html lang="fa">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>هودی مردانه | متن چسبیده</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      background: #f9f9f9;
      padding: 20px;
      text-align: center;
    }
    model-viewer {
      width: 100%;
      height: 500px;
      background: #fff;
      border-radius: 16px;
    }
    .controls {
      margin-top: 20px;
    }
    input, select, button {
      padding: 10px;
      margin: 5px;
      font-size: 1rem;
      border-radius: 8px;
    }
    .color-picker {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      background: conic-gradient(red, yellow, lime, cyan, blue, magenta, red);
      margin: auto;
      cursor: pointer;
      border: 2px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>هودی مردانه</h1><model-viewer id="modelViewer" src="https://github.com/Toska-clothes/My_Toska/raw/refs/heads/main/hoodie.glb"
camera-controls interaction-prompt="none" auto-rotate ar> <canvas id="hotspotCanvas" style="position:absolute;"></canvas> </model-viewer>

  <div class="controls">
    <input type="text" id="textInput" placeholder="متن دلخواه" />
    <input type="color" id="textColor" value="#000000" />
    <select id="fontSelector">
      <option value="Arial">Arial</option>
      <option value="Tahoma">Tahoma</option>
      <option value="Vazirmatn">Vazirmatn</option>
    </select>
    <button onclick="enableTextPlacement()">افزودن متن روی مدل</button>
  </div>  <div class="controls">
    <div class="color-picker" id="colorWheel"></div>
  </div>  <script>
    const modelViewer = document.getElementById("modelViewer");
    const colorWheel = document.getElementById("colorWheel");
    colorWheel.addEventListener("click", (e) => {
      const rect = e.target.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      const angle = Math.atan2(y - 75, x - 75);
      const hue = (angle * 180 / Math.PI + 360) % 360;
      const color = `hsl(${hue}, 100%, 50%)`;
      modelViewer.addEventListener('load', () => {
        const materials = modelViewer.model.materials;
        materials.forEach(m => m.pbrMetallicRoughness.setBaseColorFactor([...hslToRgbArray(hue), 1]));
      });
    });

    function hslToRgbArray(hue) {
      let h = hue / 360, s = 1, l = 0.5;
      let r, g, b;
      const hue2rgb = (p, q, t) => {
        if (t < 0) t += 1;
        if (t > 1) t -= 1;
        if (t < 1 / 6) return p + (q - p) * 6 * t;
        if (t < 1 / 2) return q;
        if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
        return p;
      };
      const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
      const p = 2 * l - q;
      r = hue2rgb(p, q, h + 1 / 3);
      g = hue2rgb(p, q, h);
      b = hue2rgb(p, q, h - 1 / 3);
      return [r, g, b];
    }

    function enableTextPlacement() {
      modelViewer.addEventListener("click", async (event) => {
        const rect = modelViewer.getBoundingClientRect();
        const x = event.clientX - rect.left;
        const y = event.clientY - rect.top;
        const positionAndNormal = await modelViewer.positionAndNormalFromPoint(x / rect.width, y / rect.height);

        if (!positionAndNormal) return;

        const { position } = positionAndNormal;
        const text = document.getElementById("textInput").value;
        const color = document.getElementById("textColor").value;
        const font = document.getElementById("fontSelector").value;

        const annotation = document.createElement("div");
        annotation.textContent = text;
        annotation.style.position = "absolute";
        annotation.style.color = color;
        annotation.style.fontFamily = font;
        annotation.style.fontSize = "20px";
        annotation.style.transform = `translate(${x}px, ${y}px)`;
        document.body.appendChild(annotation);
      }, { once: true });
    }
  </script></body>
</html>
