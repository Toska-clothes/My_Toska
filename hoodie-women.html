<!-- ... همان head و body بالا ... فقط بخش options-container و script تغییر کرده -->

<div class="options-container">
  <label class="label">رنگ:</label>
  <div class="color-picker">
    <div class="color-circle" data-color="red" style="background-color: red;"></div>
    <div class="color-circle" data-color="blue" style="background-color: blue;"></div>
    <div class="color-circle" data-color="black" style="background-color: black;"></div>
    <div class="color-circle" data-color="white" style="background-color: white; border: 1px solid #aaa;"></div>
  </div>

  <label class="label" for="textInput">متن دلخواه:</label>
  <input type="text" id="textInput" placeholder="مثلاً: دختر قوی"/>
  <button onclick="applyText()">اعمال متن</button>
</div>

<model-viewer id="hoodieModel"
              src="hoodie.glb"
              alt="3D Hoodie"
              auto-rotate
              camera-controls
              ar
              exposure="1"
              shadow-intensity="1">
  <div id="textLabel" slot="hotspot-0" class="hotspot" data-position="0 1 0.2" data-normal="0 0 1" style="pointer-events: none; font-weight: bold; font-size: 1.2rem; color: #000;"></div>
</model-viewer>

<script>
  const modelViewer = document.getElementById("hoodieModel");
  const colorCircles = document.querySelectorAll(".color-circle");
  const textLabel = document.getElementById("textLabel");

  const colorMap = {
    red: "#ff0000",
    blue: "#0000ff",
    black: "#000000",
    white: "#ffffff"
  };

  function hexToRgba(hex) {
    const bigint = parseInt(hex.slice(1), 16);
    const r = ((bigint >> 16) & 255) / 255;
    const g = ((bigint >> 8) & 255) / 255;
    const b = (bigint & 255) / 255;
    return [r, g, b, 1];
  }

  async function changeColor(colorName) {
    const hex = colorMap[colorName];
    const rgba = hexToRgba(hex);
    await modelViewer.updateComplete;
    const material = modelViewer.model.materials[0];
    if (material) {
      material.pbrMetallicRoughness.setBaseColorFactor(rgba);
    }
  }

  colorCircles.forEach(circle => {
    circle.addEventListener("click", () => {
      colorCircles.forEach(c => c.classList.remove("selected"));
      circle.classList.add("selected");
      const selectedColor = circle.getAttribute("data-color");
      changeColor(selectedColor);
    });
  });

  function applyText() {
    const input = document.getElementById("textInput").value;
    textLabel.innerText = input;
  }
</script>

<style>
  .hotspot {
    background: rgba(255, 255, 255, 0.7);
    padding: 5px 10px;
    border-radius: 12px;
    border: 1px solid #aaa;
  }
</style>
